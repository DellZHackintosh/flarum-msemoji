{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flarum/emoji/webpack/bootstrap","webpack://@flarum/emoji/webpack/runtime/compat get default export","webpack://@flarum/emoji/webpack/runtime/define property getters","webpack://@flarum/emoji/webpack/runtime/hasOwnProperty shorthand","webpack://@flarum/emoji/webpack/runtime/make namespace object","webpack://@flarum/emoji/./node_modules/msemoji/dist/msemoji.esm.js","webpack://@flarum/emoji/external root \"flarum.core.compat['common/extend']\"","webpack://@flarum/emoji/external root \"flarum.core.compat['common/components/TextEditor']\"","webpack://@flarum/emoji/external root \"flarum.core.compat['common/components/TextEditorButton']\"","webpack://@flarum/emoji/external root \"flarum.core.compat['forum/utils/KeyboardNavigatable']\"","webpack://@flarum/emoji/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flarum/emoji/external root \"flarum.core.compat['common/Fragment']\"","webpack://@flarum/emoji/./src/forum/fragments/AutocompleteDropdown.js","webpack://@flarum/emoji/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flarum/emoji/./src/forum/helpers/getEmojiIconCode.js","webpack://@flarum/emoji/external root \"flarum.core.compat['app']\"","webpack://@flarum/emoji/./src/forum/options.js","webpack://@flarum/emoji/external root \"flarum.core.compat['common/models/Post']\"","webpack://@flarum/emoji/./src/forum/index.js","webpack://@flarum/emoji/./src/forum/addComposerAutocomplete.js","webpack://@flarum/emoji/./src/forum/renderEmoji.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */\n/*! msemoji is modified from twemoji by DaleZ(DellZHackintosh). Licensed inherits Twemoji. */\nvar msemoji=function(){\"use strict\";var msemoji={base:\"https://raw.githubusercontent.com/DellZHackintosh/msemoji/main/src/\",ext:\".png\",size:\"72x72\",className:\"emoji\",high_contrast:false,version:\"1.1.2\",convert:{fromCodePoint:fromCodePoint,toCodePoint:toCodePoint},onerror:function onerror(){if(this.parentNode){this.parentNode.replaceChild(createText(this.alt,false),this)}},parse:parse,replace:replace,test:test},escaper={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",\"'\":\"&#39;\",'\"':\"&quot;\"},re=/\\ud83e\\udd1d|(?:\\ud83d[\\udc68\\udc69]|\\ud83e\\uddd1)(?:\\ud83c[\\udffb-\\udfff])?\\u200d(?:\\u2695\\ufe0f|\\u2696\\ufe0f|\\u2708\\ufe0f|\\ud83c[\\udf3e\\udf73\\udf7c\\udf93\\udfa4\\udfa8\\udfeb\\udfed]|\\ud83d[\\udcbc\\udd27\\udd2c\\ude80\\ude92]|\\ud83e[\\uddaf-\\uddb3\\uddbc\\uddbd])|\\ud83e\\uddd1(?:\\ud83c[\\udffb-\\udfff])?\\u200d\\uD83C\\uDF84|\\ud83d\\udd74(?:\\ud83c[\\udffb-\\udfff]|\\ufe0f)|\\ud83d\\udd75(?:(?:\\ud83c[\\udffb-\\udfff])?\\u200d(\\u2640|\\u2642)\\ufe0f|\\ufe0f(\\u200d(\\u2640|\\u2642)\\ufe0f)?)|(?:\\ud83c[\\udfcb\\udfcc]|\\u26f9)((?:\\ud83c[\\udffb-\\udfff]|\\ufe0f)\\u200d[\\u2640\\u2642]\\ufe0f)|(?:\\ud83c[\\udfc3\\udfc4\\udfca]|\\ud83d[\\udc6e\\udc70\\udc71\\udc73\\udc77\\udc81\\udc82\\udc86\\udc87\\ude45-\\ude47\\ude4b\\ude4d\\ude4e\\udea3\\udeb4-\\udeb6]|\\ud83e[\\udd26\\udd35\\udd37-\\udd39\\udd3d\\udd3e\\uddb8\\uddb9\\uddcd-\\uddcf\\uddd4\\uddd6-\\udddd])(?:\\ud83c[\\udffb-\\udfff])?\\u200d[\\u2640\\u2642]\\ufe0f|(?:\\ud83c\\udff3\\ufe0f\\u200d\\u26a7\\ufe0f|\\ud83c\\udff3\\ufe0f\\u200d\\ud83c\\udf08|\\ud83d\\ude36\\u200d\\ud83c\\udf2b\\ufe0f|\\ud83d\\udc41\\ufe0f\\u200d\\ud83d\\udde8\\ufe0f|\\u2764\\ufe0f\\u200d\\ud83d\\udd25|\\u2764\\ufe0f\\u200d\\ud83e\\ude79|\\ud83c\\udff4\\u200d\\u2620\\ufe0f|\\ud83d\\udc15\\u200d\\ud83e\\uddba|\\ud83d\\udc3b\\u200d\\u2744\\ufe0f|\\ud83d\\udc6f\\u200d\\u2640\\ufe0f|\\ud83d\\udc6f\\u200d\\u2642\\ufe0f|\\ud83d\\ude2e\\u200d\\ud83d\\udca8|\\ud83d\\ude35\\u200d\\ud83d\\udcab|\\ud83e\\udd3c\\u200d\\u2640\\ufe0f|\\ud83e\\udd3c\\u200d\\u2642\\ufe0f|\\ud83e\\uddde\\u200d\\u2640\\ufe0f|\\ud83e\\uddde\\u200d\\u2642\\ufe0f|\\ud83e\\udddf\\u200d\\u2640\\ufe0f|\\ud83e\\udddf\\u200d\\u2642\\ufe0f|\\ud83d\\udc08\\u200d\\u2b1b)|[#*0-9]\\ufe0f?\\u20e3|(?:[©®\\u2122\\u265f]\\ufe0f)|(?:\\ud83c[\\udc04\\udd70\\udd71\\udd7e\\udd7f\\ude02\\ude1a\\ude2f\\ude37\\udf21\\udf24-\\udf2c\\udf36\\udf7d\\udf96\\udf97\\udf99-\\udf9b\\udf9e\\udf9f\\udfcd\\udfce\\udfd4-\\udfdf\\udff3\\udff5\\udff7]|\\ud83d[\\udc3f\\udc41\\udcfd\\udd49\\udd4a\\udd6f\\udd70\\udd73\\udd76-\\udd79\\udd87\\udd8a-\\udd8d\\udda5\\udda8\\uddb1\\uddb2\\uddbc\\uddc2-\\uddc4\\uddd1-\\uddd3\\udddc-\\uddde\\udde1\\udde3\\udde8\\uddef\\uddf3\\uddfa\\udecb\\udecd-\\udecf\\udee0-\\udee5\\udee9\\udef0\\udef3]|[\\u203c\\u2049\\u2139\\u2194-\\u2199\\u21a9\\u21aa\\u231a\\u231b\\u2328\\u23cf\\u23ed-\\u23ef\\u23f1\\u23f2\\u23f8-\\u23fa\\u24c2\\u25aa\\u25ab\\u25b6\\u25c0\\u25fb-\\u25fe\\u2600-\\u2604\\u260e\\u2611\\u2614\\u2615\\u2618\\u2620\\u2622\\u2623\\u2626\\u262a\\u262e\\u262f\\u2638-\\u263a\\u2640\\u2642\\u2648-\\u2653\\u2660\\u2663\\u2665\\u2666\\u2668\\u267b\\u267f\\u2692-\\u2697\\u2699\\u269b\\u269c\\u26a0\\u26a1\\u26a7\\u26aa\\u26ab\\u26b0\\u26b1\\u26bd\\u26be\\u26c4\\u26c5\\u26c8\\u26cf\\u26d1\\u26d3\\u26d4\\u26e9\\u26ea\\u26f0-\\u26f5\\u26f8\\u26fa\\u26fd\\u2702\\u2708\\u2709\\u270f\\u2712\\u2714\\u2716\\u271d\\u2721\\u2733\\u2734\\u2744\\u2747\\u2757\\u2763\\u2764\\u27a1\\u2934\\u2935\\u2b05-\\u2b07\\u2b1b\\u2b1c\\u2b50\\u2b55\\u3030\\u303d\\u3297\\u3299])(?:\\ufe0f|(?!\\ufe0e))|\\u26f7\\ufe0f|(?:(?:\\ud83c[\\udfcb\\udfcc]|\\ud83d[\\udd74\\udd75\\udd90]|[\\u261d\\u26f9\\u270c\\u270d])(?:\\ufe0f|(?!\\ufe0e))|(?:\\ud83c[\\udf85\\udfc2-\\udfc4\\udfc7\\udfca]|\\ud83d[\\udc42\\udc43\\udc46-\\udc50\\udc66-\\udc69\\udc6e\\udc70-\\udc78\\udc7c\\udc81-\\udc83\\udc85-\\udc87\\udcaa\\udd7a\\udd95\\udd96\\ude45-\\ude47\\ude4b-\\ude4f\\udea3\\udeb4-\\udeb6\\udec0\\udecc]|\\ud83e[\\udd0c\\udd0f\\udd18-\\udd1c\\udd1e\\udd1f\\udd26\\udd30-\\udd39\\udd3d\\udd3e\\udd77\\uddb5\\uddb6\\uddb8\\uddb9\\uddbb\\uddcd-\\uddcf\\uddd1-\\udddd\\udec3-\\udec5\\udef0-\\udef6]|[\\u270a\\u270b]))(?:\\ud83c[\\udffb-\\udfff])?|(?:\\ud83c[\\udccf\\udd8e\\udd91-\\udd9a\\ude01\\ude32-\\ude36\\ude38-\\ude3a\\ude50\\ude51\\udf00-\\udf20\\udf2d-\\udf35\\udf37-\\udf7c\\udf7e-\\udf84\\udf86-\\udf93\\udfa0-\\udfad\\udfaf-\\udfc1\\udfc5\\udfc6\\udfc8\\udfc9\\udfcf-\\udfd3\\udfe0-\\udff0\\udff4\\udff8-\\udffa]|\\ud83d[\\udc00-\\udc3e\\udc40\\udc44\\udc45\\udc51-\\udc65\\udc6f\\udc79-\\udc7b\\udc7d-\\udc80\\udc84\\udc88-\\udc8e\\udc90\\udc92-\\udca9\\udcab-\\udccd\\udccf-\\udcfc\\udcff-\\udd3d\\udd4b-\\udd4e\\udd50-\\udd67\\udda4\\uddfb-\\ude44\\ude48-\\ude4a\\ude80-\\udea2\\udea4-\\udeb3\\udeb7-\\udebf\\udec1-\\udec5\\uded0-\\uded2\\uded5-\\uded7\\udedd-\\udedf\\udeeb\\udeec\\udef4-\\udefc\\udfe0-\\udfeb\\udff0]|\\ud83e[\\udd0d\\udd0e\\udd10-\\udd17\\udd20-\\udd25\\udd27-\\udd2f\\udd3a\\udd3c\\udd3f-\\udd45\\udd47-\\udd76\\udd78-\\uddaf\\uddb4\\uddb7\\uddba\\uddbc-\\uddcc\\uddd0\\uddde-\\uddff\\ude70-\\ude74\\ude78-\\ude7c\\ude80-\\ude86\\ude90-\\udeac\\udeb0-\\udeba\\udec0-\\udec2\\uded0-\\uded9\\udee0-\\udee7]|[\\u23e9-\\u23ec\\u23f0\\u23f3\\u267e\\u26ce\\u2705\\u2728\\u274c\\u274e\\u2753-\\u2755\\u2795-\\u2797\\u27b0\\u27bf])|\\ufe0f/g,UFE0Fg=/\\uFE0F/g,U200D=String.fromCharCode(8205),rescaper=/[&<>'\"]/g,shouldntBeParsed=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,fromCharCode=String.fromCharCode;return msemoji;function createText(text,clean){return document.createTextNode(clean?text.replace(UFE0Fg,\"\"):text)}function escapeHTML(s){return s.replace(rescaper,replacer)}function defaultImageSrcGenerator(icon,options){return\"\".concat(options.base,options.size,\"/\",icon,options.ext)}function grabAllTextNodes(node,allText){var childNodes=node.childNodes,length=childNodes.length,subnode,nodeType;while(length--){subnode=childNodes[length];nodeType=subnode.nodeType;if(nodeType===3){allText.push(subnode)}else if(nodeType===1&&!(\"ownerSVGElement\"in subnode)&&!shouldntBeParsed.test(subnode.nodeName.toLowerCase())){grabAllTextNodes(subnode,allText)}}return allText}function grabTheRightIcon(rawText){return toCodePoint(rawText.indexOf(U200D)<0?rawText.replace(UFE0Fg,\"\"):rawText)}function parseNode(node,options){var allText=grabAllTextNodes(node,[]),length=allText.length,attrib,attrname,modified,fragment,subnode,text,match,i,index,img,rawText,iconId,src;while(length--){modified=false;fragment=document.createDocumentFragment();subnode=allText[length];text=subnode.nodeValue;i=0;while(match=re.exec(text)){index=match.index;if(index!==i){fragment.appendChild(createText(text.slice(i,index),true))}rawText=match[0];iconId=grabTheRightIcon(rawText);i=index+rawText.length;src=options.callback(iconId,options);if(iconId&&src){img=new Image;img.onerror=options.onerror;img.setAttribute(\"draggable\",\"false\");attrib=options.attributes(rawText,iconId);for(attrname in attrib){if(attrib.hasOwnProperty(attrname)&&attrname.indexOf(\"on\")!==0&&!img.hasAttribute(attrname)){img.setAttribute(attrname,attrib[attrname])}}img.className=options.className;img.alt=rawText;img.src=options.high_contrast?src.replace(/-1f3f[bcdef]/g,\"\"):src;modified=true;fragment.appendChild(img)}if(!img)fragment.appendChild(createText(rawText,false));img=null}if(modified){if(i<text.length){fragment.appendChild(createText(text.slice(i),true))}subnode.parentNode.replaceChild(fragment,subnode)}}return node}function parseString(str,options){return replace(str,function(rawText){var ret=rawText,iconId=grabTheRightIcon(rawText),src=options.callback(options.high_contrast?iconId.replace(/-1f3f[bcdef]/g,\"\"):iconId,options),attrib,attrname;if(iconId&&src){ret=\"<img \".concat('class=\"',options.className,'\" ','draggable=\"false\" ','alt=\"',rawText,'\"',' src=\"',src,'\"');attrib=options.attributes(rawText,iconId);for(attrname in attrib){if(attrib.hasOwnProperty(attrname)&&attrname.indexOf(\"on\")!==0&&ret.indexOf(\" \"+attrname+\"=\")===-1){ret=ret.concat(\" \",attrname,'=\"',escapeHTML(attrib[attrname]),'\"')}}ret=ret.concat(\"/>\")}return ret})}function replacer(m){return escaper[m]}function returnNull(){return null}function toSizeSquaredAsset(value){return typeof value===\"number\"?value+\"x\"+value:value}function fromCodePoint(codepoint){var code=typeof codepoint===\"string\"?parseInt(codepoint,16):codepoint;if(code<65536){return fromCharCode(code)}code-=65536;return fromCharCode(55296+(code>>10),56320+(code&1023))}function parse(what,how){if(!how||typeof how===\"function\"){how={callback:how}}return(typeof what===\"string\"?parseString:parseNode)(what,{callback:how.callback||defaultImageSrcGenerator,attributes:typeof how.attributes===\"function\"?how.attributes:returnNull,base:typeof how.base===\"string\"?how.base:msemoji.base,ext:how.ext||msemoji.ext,size:how.folder||toSizeSquaredAsset(how.size||msemoji.size),className:how.className||msemoji.className,onerror:how.onerror||msemoji.onerror})}function replace(text,callback){return String(text).replace(re,callback)}function test(text){re.lastIndex=0;var result=re.test(text);re.lastIndex=0;return result}function toCodePoint(unicodeSurrogates,sep){var r=[],c=0,p=0,i=0;while(i<unicodeSurrogates.length){c=unicodeSurrogates.charCodeAt(i++);if(p){r.push((65536+(p-55296<<10)+(c-56320)).toString(16));p=0}else if(55296<=c&&c<=56319){p=c}else{r.push(c.toString(16))}}return r.join(sep||\"-\")}}();\nexport default msemoji;","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditor'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditorButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/KeyboardNavigatable'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Fragment'];","import Fragment from 'flarum/common/Fragment';\n\nexport default class AutocompleteDropdown extends Fragment {\n  items = [];\n  active = false;\n  index = 0;\n  keyWasJustPressed = false;\n\n  view() {\n    return (\n      <ul className=\"Dropdown-menu EmojiDropdown\">\n        <li className=\"Dropdown-header\">{app.translator.trans('flarum-msemoji.forum.composer.type_to_search_text')}</li>\n        {this.items.map((item) => (\n          <li key={item.attrs.key}>{item}</li>\n        ))}\n      </ul>\n    );\n  }\n\n  show(left, top) {\n    this.$()\n      .show()\n      .css({\n        left: left + 'px',\n        top: top + 'px',\n      });\n    this.active = true;\n  }\n\n  hide() {\n    this.$().hide();\n    this.active = false;\n  }\n\n  navigate(delta) {\n    this.keyWasJustPressed = true;\n    this.setIndex(this.index + delta, true);\n    clearTimeout(this.keyWasJustPressedTimeout);\n    this.keyWasJustPressedTimeout = setTimeout(() => (this.keyWasJustPressed = false), 500);\n  }\n\n  complete() {\n    this.$('li:not(.Dropdown-header)').eq(this.index).find('button').click();\n  }\n\n  setIndex(index, scrollToItem) {\n    if (this.keyWasJustPressed && !scrollToItem) return;\n\n    const $dropdown = this.$();\n    const $items = $dropdown.find('li:not(.Dropdown-header)');\n    let rangedIndex = index;\n\n    if (rangedIndex < 0) {\n      rangedIndex = $items.length - 1;\n    } else if (rangedIndex >= $items.length) {\n      rangedIndex = 0;\n    }\n\n    this.index = rangedIndex;\n\n    const $item = $items.removeClass('active').eq(rangedIndex).addClass('active');\n\n    if (scrollToItem) {\n      const dropdownScroll = $dropdown.scrollTop();\n      const dropdownTop = $dropdown.offset().top;\n      const dropdownBottom = dropdownTop + $dropdown.outerHeight();\n      const itemTop = $item.offset().top;\n      const itemBottom = itemTop + $item.outerHeight();\n\n      let scrollTop;\n      if (itemTop < dropdownTop) {\n        scrollTop = dropdownScroll - dropdownTop + itemTop - parseInt($dropdown.css('padding-top'), 10);\n      } else if (itemBottom > dropdownBottom) {\n        scrollTop = dropdownScroll - dropdownBottom + itemBottom + parseInt($dropdown.css('padding-bottom'), 10);\n      }\n\n      if (typeof scrollTop !== 'undefined') {\n        $dropdown.stop(true).animate({ scrollTop }, 100);\n      }\n    }\n  }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */ /*\n  https://github.com/twitter/twemoji/blob/gh-pages/LICENSE\n*/\n\nimport msemoji from 'msemoji';\n\n// avoid using a string literal like '\\u200D' here because minifiers expand it inline\nconst U200D = String.fromCharCode(0x200d);\n\n// avoid runtime RegExp creation for not so smart,\n// not JIT based, and old browsers / engines\nconst UFE0Fg = /\\uFE0F/g;\n\n/**\n * Used to both remove the possible variant\n *  and to convert utf16 into code points.\n *  If there is a zero-width-joiner (U+200D), leave the variants in.\n * @param   string    the raw text of the emoji match\n * @return  string    the code point\n */\nexport default function getEmojiIconCode(emoji) {\n  return msemoji.convert.toCodePoint(emoji.indexOf(U200D) < 0 ? emoji.replace(UFE0Fg, '') : emoji);\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['app'];","import app from 'flarum/app';\n\nimport msemoji from 'msemoji';\n\nexport const version = msemoji.version[0];\n\nexport default function (n) {\n    switch (n) {\n        default: case 0:\n            return app.forum.attribute(\"flarum-msemoji.base\") ?\n            app.forum.attribute(\"flarum-msemoji.base\").replace('${Version}', version) :\n            msemoji.base;\n            break;\n\n        case 1:\n            return app.forum.attribute(\"flarum-msemoji.folder\");\n            break;\n\n        case 2:\n            return app.forum.attribute(\"flarum-msemoji.ext\");\n    }\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Post'];","import addComposerAutocomplete from './addComposerAutocomplete';\nimport renderEmoji from './renderEmoji';\n\napp.initializers.add('flarum-msemoji', () => {\n  // After typing ':' in the composer, show a dropdown suggesting a bunch of\n  // emoji that the user could use.\n  new Promise(function (resolve) {\n    var id = setInterval(function () {\n      if (app.forum) {\n        if (app.forum.attribute) {\n          clearInterval(id);\n          resolve();\n        }\n      }\n    }, 500)\n  }).then(function () {\n    if (app.forum.attribute(\"flarum-msemoji.disable_autocomplete\") != '1') addComposerAutocomplete();\n  })\n\n  // render emoji as image in Posts content and title.\n  renderEmoji();\n});\n","import msemoji from 'msemoji';\nimport emojiMap from 'simple-emoji-map';\n\nimport { extend } from 'flarum/common/extend';\nimport TextEditor from 'flarum/common/components/TextEditor';\nimport TextEditorButton from 'flarum/common/components/TextEditorButton';\nimport KeyboardNavigatable from 'flarum/forum/utils/KeyboardNavigatable';\n\nimport AutocompleteDropdown from './fragments/AutocompleteDropdown';\nimport getEmojiIconCode from './helpers/getEmojiIconCode';\nimport getoption from './options';\n\nexport default function addComposerAutocomplete() {\n  const emojiKeys = Object.keys(emojiMap);\n  const $container = $('<div class=\"ComposerBody-emojiDropdownContainer\"></div>');\n  const dropdown = new AutocompleteDropdown();\n\n  extend(TextEditor.prototype, 'oncreate', function () {\n    const $editor = this.$('.TextEditor-editor').wrap('<div class=\"ComposerBody-emojiWrapper\"></div>');\n\n    this.navigator = new KeyboardNavigatable();\n    this.navigator\n      .when(() => dropdown.active)\n      .onUp(() => dropdown.navigate(-1))\n      .onDown(() => dropdown.navigate(1))\n      .onSelect(dropdown.complete.bind(dropdown))\n      .onCancel(dropdown.hide.bind(dropdown))\n      .bindTo($editor);\n\n    $editor.after($container);\n  });\n\n  extend(TextEditor.prototype, 'buildEditorParams', function (params) {\n    let relEmojiStart;\n    let absEmojiStart;\n    let typed;\n\n    const applySuggestion = (replacement) => {\n      this.attrs.composer.editor.replaceBeforeCursor(absEmojiStart - 1, replacement + ' ');\n\n      dropdown.hide();\n    };\n\n    params.inputListeners.push(() => {\n      const selection = this.attrs.composer.editor.getSelectionRange();\n\n      const cursor = selection[0];\n\n      if (selection[1] - cursor > 0) return;\n\n      // Search backwards from the cursor for an ':' symbol. If we find\n      // one and followed by a whitespace, we will want to show the\n      // autocomplete dropdown!\n      const lastChunk = this.attrs.composer.editor.getLastNChars(15);\n      absEmojiStart = 0;\n      for (let i = lastChunk.length - 1; i >= 0; i--) {\n        const character = lastChunk.substr(i, 1);\n        // check what user typed, emoji names only contains alphanumeric,\n        // underline, '+' and '-'\n        if (!/[a-z0-9]|\\+|\\-|_|\\:/.test(character)) break;\n        // make sure ':' preceded by a whitespace or newline\n        if (character === ':' && (i == 0 || /\\s/.test(lastChunk.substr(i - 1, 1)))) {\n          relEmojiStart = i + 1;\n          absEmojiStart = cursor - lastChunk.length + i + 1;\n          break;\n        }\n      }\n\n      dropdown.hide();\n      dropdown.active = false;\n\n      if (absEmojiStart) {\n        typed = lastChunk.substring(relEmojiStart).toLowerCase();\n\n        const makeSuggestion = function ({ emoji, name, code }) {\n          return (\n            <button\n              key={emoji}\n              onclick={() => applySuggestion(emoji)}\n              onmouseenter={function () {\n                dropdown.setIndex($(this).parent().index() - 1);\n              }}\n            >\n              <img alt={emoji} class=\"emoji\" draggable=\"false\" loading=\"lazy\" src={`${getoption()}${getoption(1) || msemoji.size}/${code}${getoption(2) || msemoji.ext}`} />\n              {name}\n            </button>\n          );\n        };\n\n        const buildSuggestions = () => {\n          const similarEmoji = [];\n\n          // Build a regular expression to do a fuzzy match of the given input string\n          const fuzzyRegexp = function (str) {\n            const reEscape = new RegExp('\\\\(([' + '+.*?[]{}()^$|\\\\'.replace(/(.)/g, '\\\\$1') + '])\\\\)', 'g');\n            return new RegExp('(.*)' + str.toLowerCase().replace(/(.)/g, '($1)(.*?)').replace(reEscape, '(\\\\$1)') + '$', 'i');\n          };\n          const regTyped = fuzzyRegexp(typed);\n\n          let maxSuggestions = 7;\n\n          const findMatchingEmojis = (matcher) => {\n            for (let i = 0; i < emojiKeys.length && maxSuggestions > 0; i++) {\n              const curEmoji = emojiKeys[i];\n\n              if (similarEmoji.indexOf(curEmoji) === -1) {\n                const names = emojiMap[curEmoji];\n                for (let name of names) {\n                  if (matcher(name)) {\n                    --maxSuggestions;\n                    similarEmoji.push(curEmoji);\n                    break;\n                  }\n                }\n              }\n            }\n          };\n\n          // First, try to find all emojis starting with the given string\n          findMatchingEmojis((emoji) => emoji.indexOf(typed) === 0);\n\n          // If there are still suggestions left, try for some fuzzy matches\n          findMatchingEmojis((emoji) => regTyped.test(emoji));\n\n          const suggestions = similarEmoji\n            .map((emoji) => ({\n              emoji,\n              name: emojiMap[emoji][0],\n              code: getEmojiIconCode(emoji),\n            }))\n            .map(makeSuggestion);\n\n          if (suggestions.length) {\n            dropdown.items = suggestions;\n            m.render($container[0], dropdown.render());\n\n            dropdown.show();\n            const coordinates = this.attrs.composer.editor.getCaretCoordinates(absEmojiStart);\n            const width = dropdown.$().outerWidth();\n            const height = dropdown.$().outerHeight();\n            const parent = dropdown.$().offsetParent();\n            let left = coordinates.left;\n            let top = coordinates.top + 15;\n\n            // Keep the dropdown inside the editor.\n            if (top + height > parent.height()) {\n              top = coordinates.top - height - 15;\n            }\n            if (left + width > parent.width()) {\n              left = parent.width() - width;\n            }\n\n            // Prevent the dropdown from going off screen on mobile\n            top = Math.max(-(parent.offset().top - $(document).scrollTop()), top);\n            left = Math.max(-parent.offset().left, left);\n\n            dropdown.show(left, top);\n          }\n        };\n\n        buildSuggestions();\n\n        dropdown.setIndex(0);\n        dropdown.$().scrollTop(0);\n        dropdown.active = true;\n      }\n    });\n  });\n\n  extend(TextEditor.prototype, 'toolbarItems', function (items) {\n    items.add(\n      'emoji',\n      <TextEditorButton onclick={() => this.attrs.composer.editor.insertAtCursor(' :')} icon=\"far fa-smile\">\n        {app.translator.trans('flarum-msemoji.forum.composer.emoji_tooltip')}\n      </TextEditorButton>\n    );\n  });\n}\n","import msemoji from 'msemoji';\n\nimport { override } from 'flarum/common/extend';\nimport Post from 'flarum/common/models/Post';\n\nimport getoption from './options';\n\n/**\n * Parses an HTML string into a `<body>` node containing the HTML content.\n *\n * Vanilla JS implementation of jQuery's `$.parseHTML()`,\n * sourced from http://youmightnotneedjquery.com/\n */\nfunction parseHTML(str) {\n  const tmp = document.implementation.createHTMLDocument();\n  tmp.body.innerHTML = str;\n  return tmp.body;\n}\n\nexport default function renderEmoji() {\n  override(Post.prototype, 'contentHtml', function (original) {\n    const contentHtml = original();\n\n    if (this.oldContentHtml !== contentHtml) {\n      // We need to parse the HTML string into a DOM node, then give it to Twemoji.\n      //\n      // This prevents some issues with the default find-replace that would be performed\n      // on a string passed to `Twemoji.parse()`.\n      //\n      // The parse function can only handle a single DOM node provided, so we need to\n      // wrap it in a node. In our `parseHTML` implementation, we wrap it in a `<body>`\n      // element. This gets stripped below.\n      //\n      // See https://github.com/flarum/core/issues/2958\n      const emojifiedDom = msemoji.parse(parseHTML(contentHtml), {\n        base: getoption(),\n        folder: getoption(1),\n        ext: getoption(2),\n        attributes: () => ({\n          loading: 'lazy',\n        }),\n      });\n\n      // Steal the HTML string inside the emojified DOM `<body>` tag.\n      this.emojifiedContentHtml = emojifiedDom.innerHTML;\n\n      this.oldContentHtml = contentHtml;\n    }\n\n    return this.emojifiedContentHtml;\n  });\n\n  override(s9e.TextFormatter, 'preview', (original, text, element) => {\n    original(text, element);\n\n    msemoji.parse(element, {\n      base: getoption(),\n      folder: getoption(1),\n      ext: getoption(2),\n      attributes: () => ({\n        loading: 'lazy',\n      }),\n    });\n  });\n}"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","msemoji","base","ext","size","className","high_contrast","version","convert","fromCodePoint","codepoint","code","parseInt","fromCharCode","toCodePoint","onerror","this","parentNode","replaceChild","createText","alt","parse","what","how","callback","parseString","parseNode","defaultImageSrcGenerator","attributes","returnNull","folder","replace","test","text","re","lastIndex","result","escaper","UFE0Fg","U200D","String","rescaper","shouldntBeParsed","clean","document","createTextNode","icon","options","concat","grabAllTextNodes","node","allText","subnode","nodeType","childNodes","length","push","nodeName","toLowerCase","grabTheRightIcon","rawText","indexOf","attrib","attrname","modified","fragment","match","i","index","img","iconId","src","createDocumentFragment","nodeValue","exec","appendChild","slice","Image","setAttribute","hasAttribute","str","ret","replacer","m","unicodeSurrogates","sep","r","c","p","charCodeAt","toString","join","flarum","core","compat","_setPrototypeOf","setPrototypeOf","bind","__proto__","AutocompleteDropdown","_Fragment","subClass","superClass","_this","_len","arguments","args","Array","_key","apply","items","active","keyWasJustPressed","create","constructor","_proto","view","app","translator","trans","map","item","attrs","show","left","top","$","css","hide","navigate","delta","_this2","setIndex","clearTimeout","keyWasJustPressedTimeout","setTimeout","complete","eq","find","click","scrollToItem","$dropdown","$items","rangedIndex","$item","removeClass","addClass","scrollTop","dropdownScroll","dropdownTop","offset","dropdownBottom","outerHeight","itemTop","itemBottom","stop","animate","Fragment","getEmojiIconCode","emoji","n","attribute","initializers","add","Promise","resolve","id","setInterval","forum","clearInterval","then","emojiKeys","$container","dropdown","keys","emojiMap","extend","TextEditor","$editor","wrap","navigator","KeyboardNavigatable","when","onUp","onDown","onSelect","onCancel","bindTo","after","params","relEmojiStart","absEmojiStart","typed","inputListeners","selection","composer","editor","getSelectionRange","cursor","lastChunk","getLastNChars","character","substr","substring","makeSuggestion","_ref","name","onclick","replacement","replaceBeforeCursor","onmouseenter","parent","class","draggable","loading","getoption","reEscape","similarEmoji","regTyped","RegExp","maxSuggestions","findMatchingEmojis","matcher","curEmoji","_step","_iterator","_createForOfIteratorHelperLoose","done","suggestions","render","coordinates","getCaretCoordinates","width","outerWidth","height","offsetParent","Math","max","buildSuggestions","TextEditorButton","insertAtCursor","override","Post","original","tmp","contentHtml","oldContentHtml","emojifiedDom","implementation","createHTMLDocument","body","innerHTML","emojifiedContentHtml","s9e","TextFormatter","element"],"sourceRoot":""}